<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Obstacle Game</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #808080;
        }
        #gameCanvas {
            display: block;
            margin: 0 auto;
        }
        #startScreen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-family: Arial, sans-serif;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="startScreen">
        <h1>Car Obstacle Game</h1>
        <p>Press SPACE to start/restart</p>
        <p>Use UP/DOWN/LEFT/RIGHT arrows or W/S/A/D keys to move</p>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startScreen = document.getElementById('startScreen');

        let canvasWidth = 800;
        let canvasHeight = 400;

        canvas.width = canvasWidth;
        canvas.height = canvasHeight;

        const car = {
            x: 100,
            y: canvasHeight / 2,
            width: 80,
            height: 40,
            speed: 5,
            moveUp: false,
            moveDown: false,
            moveLeft: false,
            moveRight: false
        };

        let obstacles = [];
        let animationId;
        let isGameOver = true;
        let score = 0;
        let backgroundX = 0;

        // Create car SVG
        const carSvg = `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 40">
            <path d="M10,20 Q15,5 30,10 L60,10 Q75,15 70,30 H10 Z" fill="red" stroke="black" stroke-width="2"/>
            <circle cx="25" cy="30" r="7" fill="black"/>
            <circle cx="55" cy="30" r="7" fill="black"/>
            <path d="M60,10 L60,20 Q50,22 40,20 Q30,18 30,10 Z" fill="lightblue"/>
        </svg>`;

        const carImg = new Image();
        carImg.src = 'data:image/svg+xml;base64,' + btoa(carSvg);

        // Create monster SVG
        const monsterSvg = `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 60">
            <path d="M5,30 Q0,0 20,5 Q40,0 35,30 Q40,60 20,55 Q0,60 5,30 Z" fill="purple" stroke="black" stroke-width="2"/>
            <circle cx="12" cy="20" r="5" fill="yellow"/>
            <circle cx="28" cy="20" r="5" fill="yellow"/>
            <path d="M10,40 Q20,50 30,40" fill="none" stroke="red" stroke-width="3"/>
            <path d="M5,10 L0,0 M35,10 L40,0" fill="none" stroke="black" stroke-width="2"/>
        </svg>`;

        const monsterImg = new Image();
        monsterImg.src = 'data:image/svg+xml;base64,' + btoa(monsterSvg);

        function drawCar() {
            ctx.drawImage(carImg, car.x, car.y, car.width, car.height);
        }

        function drawObstacles() {
            obstacles.forEach(obstacle => {
                ctx.drawImage(monsterImg, obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            });
        }

        function drawBackground() {
            // Gray background
            ctx.fillStyle = '#808080';
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);

            // Draw two-lane crosswalk
            const laneWidth = 60;
            const lineWidth = 20;
            const lineGap = 60;
            const totalWidth = lineWidth + lineGap;
            ctx.fillStyle = '#FFFFFF';
            
            // Top lane
            const topLaneY = canvasHeight / 3 - laneWidth / 2;
            for (let x = backgroundX % totalWidth; x < canvasWidth + totalWidth; x += totalWidth) {
                ctx.fillRect(x - lineWidth, topLaneY, lineWidth, laneWidth);
            }

            // Bottom lane
            const bottomLaneY = 2 * canvasHeight / 3 - laneWidth / 2;
            for (let x = backgroundX % totalWidth; x < canvasWidth + totalWidth; x += totalWidth) {
                ctx.fillRect(x - lineWidth, bottomLaneY, lineWidth, laneWidth);
            }
        }

        function updateGame() {
            const speed = 5;
            backgroundX -= speed;
            if (backgroundX < -80) {
                backgroundX = 0;
            }

            let carMoved = false;

            if (car.moveUp) {
                car.y = Math.max(0, car.y - car.speed);
                carMoved = true;
            }
            if (car.moveDown) {
                car.y = Math.min(canvasHeight - car.height, car.y + car.speed);
                carMoved = true;
            }
            if (car.moveLeft) {
                car.x = Math.max(0, car.x - car.speed);
                carMoved = true;
            }
            if (car.moveRight) {
                car.x = Math.min(canvasWidth / 2 - car.width, car.x + car.speed);
                carMoved = true;
            }

            // If car didn't move, push it back with the background
            if (!carMoved) {
                car.x = Math.max(0, car.x - speed);
            }

            obstacles.forEach(obstacle => {
                obstacle.x -= speed;
            });

            if (obstacles.length === 0 || obstacles[obstacles.length - 1].x < canvasWidth - 300) {
                const newObstacle = {
                    x: canvasWidth,
                    y: Math.random() * (canvasHeight - 100),
                    width: 40,
                    height: 60
                };
                obstacles.push(newObstacle);
            }

            obstacles = obstacles.filter(obstacle => obstacle.x + obstacle.width > 0);

            if (obstacles.some(obstacle => 
                car.x < obstacle.x + obstacle.width &&
                car.x + car.width > obstacle.x &&
                car.y < obstacle.y + obstacle.height &&
                car.y + car.height > obstacle.y
            )) {
                gameOver();
            }

            score++;
        }

        function drawScore() {
            ctx.fillStyle = 'white';
            ctx.font = '20px Arial';
            ctx.fillText(`Score: ${score}`, 10, 30);
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);
            drawBackground();
            updateGame();
            drawObstacles();
            drawCar();
            drawScore();

            if (!isGameOver) {
                animationId = requestAnimationFrame(gameLoop);
            }
        }

        function startGame() {
            isGameOver = false;
            obstacles = [];
            score = 0;
            car.x = 100;
            car.y = canvasHeight / 2;
            startScreen.style.display = 'none';
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            gameLoop();
        }

        function gameOver() {
            isGameOver = true;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            startScreen.style.display = 'block';
            startScreen.innerHTML = `
                <h1>Game Over</h1>
                <p>Your score: ${score}</p>
                <p>Press SPACE to restart</p>
            `;
        }

        document.addEventListener('keydown', (event) => {
            if (event.code === 'Space') {
                startGame();
            } else if (event.code === 'ArrowUp' || event.code === 'KeyW') {
                car.moveUp = true;
            } else if (event.code === 'ArrowDown' || event.code === 'KeyS') {
                car.moveDown = true;
            } else if (event.code === 'ArrowLeft' || event.code === 'KeyA') {
                car.moveLeft = true;
            } else if (event.code === 'ArrowRight' || event.code === 'KeyD') {
                car.moveRight = true;
            }
        });

        document.addEventListener('keyup', (event) => {
            if (event.code === 'ArrowUp' || event.code === 'KeyW') {
                car.moveUp = false;
            } else if (event.code === 'ArrowDown' || event.code === 'KeyS') {
                car.moveDown = false;
            } else if (event.code === 'ArrowLeft' || event.code === 'KeyA') {
                car.moveLeft = false;
            } else if (event.code === 'ArrowRight' || event.code === 'KeyD') {
                car.moveRight = false;
            }
        });

        window.addEventListener('load', () => {
            startScreen.style.display = 'block';
        });
    </script>
</body>
</html>
